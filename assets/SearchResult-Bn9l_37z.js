import{f as W,u as N,g as X,h as Z,j as ee,t as te,i as ae,k as D,l as k,m as e,n as le,p as se,s as oe,R as I,q as ie,v as re,x as ne,y as ce,z as ue,A as T,B as j,C as me,D as he,E as de,F as ye,L as ve,G as pe,H as ge,I as be,J as U,K as we,M as x}from"./app-CsKX_wTB.js";const fe=["/","/git/","/metadocs/","/metadocs/great-principles.html","/metadocs/vuepress.html","/hyperion/","/hyperion/premier-pas.html","/titan/","/titan/premier-pas.html","/hyperion/beyond/","/hyperion/beyond/core.html","/hyperion/common/ECL-context.html","/hyperion/common/","/hyperion/module/","/hyperion/module/cruds.html","/hyperion/module/endpoints.html","/hyperion/module/models.html","/hyperion/module/others.html","/hyperion/module/schemas.html","/hyperion/start/","/hyperion/start/architecture.html","/hyperion/start/install.html","/hyperion/start/intro.html","/titan/beyond/","/titan/beyond/api-communication.html","/titan/beyond/convention.html","/titan/beyond/create-flutter-app.html","/titan/beyond/dart-basic.html","/titan/beyond/errors.html","/titan/beyond/exemple.html","/titan/beyond/hooks.html","/titan/beyond/install-lib.html","/titan/beyond/providers.html","/titan/beyond/routing.html","/titan/beyond/structure.html","/titan/beyond/token.html","/titan/beyond/tutoriels.html","/titan/beyond/widgets.html","/titan/common/","/titan/common/custom-widget.html","/titan/start/","/titan/start/install.html","/titan/start/intro.html","/hyperion/common/sqlalchemy/","/hyperion/common/sqlalchemy/asynchrone.html","/hyperion/common/sqlalchemy/joins.html","/hyperion/common/sqlalchemy/migrations.html","/titan/common/builders/","/titan/common/builders/async-child.html","/titan/common/builders/autoloader-child.html","/titan/common/builders/custom-builders.html","/titan/common/builders/waiting-button.html","/titan/common/layouts/","/titan/common/layouts/add-edit-button-layout.html","/titan/common/layouts/card-button.html","/titan/common/layouts/card-layout.html","/titan/common/layouts/custom-layouts.html","/titan/common/layouts/horizontal-list-view.html","/titan/common/layouts/item-chip.html","/titan/common/layouts/refresher.html","/titan/common/widgets/","/titan/common/widgets/admin-button.html","/titan/common/widgets/aling-left-test.html","/titan/common/widgets/calendar.html","/titan/common/widgets/custom-dialog-box.html","/titan/common/widgets/custom-widget.html","/titan/common/widgets/date-entry.html","/titan/common/widgets/loader.html","/titan/common/widgets/styled-search-bar.html","/titan/common/widgets/test-entry.html","/titan/common/widgets/top-bar.html","/404.html"],He="SLIMSEARCH_QUERY_HISTORY",g=U(He,[]),ke=()=>{const{queryHistoryCount:s}=x;return{enabled:s>0,queryHistories:g,addQueryHistory:n=>{g.value=Array.from(new Set([n,...g.value.slice(0,s-1)]))},removeQueryHistory:n=>{g.value=[...g.value.slice(0,n),...g.value.slice(n+1)]}}},E=s=>fe[s.id]+("anchor"in s?`#${s.anchor}`:""),xe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=x,b=U(xe,[]),qe=()=>({enabled:M>0,resultHistories:b,addResultHistory:r=>{{const n={link:E(r),display:r.display};"header"in r&&(n.header=r.header),b.value=[n,...b.value.slice(0,M-1)]}},removeResultHistory:r=>{b.value=[...b.value.slice(0,r),...b.value.slice(r+1)]}}),Re=s=>{const{page:r,routeLocale:n}=me(),q=he(),o=D(0),w=k(()=>o.value>0),m=de([]);return ye(()=>{const{search:R,terminate:y}=ve(),f=ge(v=>{const{resultsFilter:Q=l=>l,querySplitter:p,suggestionsFilter:$,...i}=q.value;v?(o.value+=1,R(v,n.value,i).then(l=>Q(l,v,n.value,r.value)).then(l=>{o.value-=1,m.value=l}).catch(l=>{console.warn(l),o.value-=1,o.value||(m.value=[])})):m.value=[]},x.searchDelay-x.suggestDelay,{maxWait:5e3});pe([s,n],([v])=>f(v.join(" "))),be(()=>{y()})}),{isSearching:w,results:m}};var Se=W({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:r}){const n=N(),q=X(),o=Z(ee),{addQueryHistory:w,queryHistories:m,removeQueryHistory:R}=ke(),{resultHistories:y,addResultHistory:f,removeResultHistory:v}=qe(),Q=te(s,"queries"),{results:p,isSearching:$}=Re(Q),i=ae({isQuery:!0,index:0}),l=D(0),h=D(0),A=k(()=>m.value.length>0||y.value.length>0),S=k(()=>p.value.length>0),C=k(()=>p.value[l.value]||null),_=()=>{const{isQuery:t,index:a}=i;a===0?(i.isQuery=!t,i.index=t?y.value.length-1:m.value.length-1):i.index=a-1},O=()=>{const{isQuery:t,index:a}=i;a===(t?m.value.length-1:y.value.length-1)?(i.isQuery=!t,i.index=0):i.index=a+1},P=()=>{l.value=l.value>0?l.value-1:p.value.length-1,h.value=C.value.contents.length-1},Y=()=>{l.value=l.value<p.value.length-1?l.value+1:0,h.value=0},z=()=>{h.value<C.value.contents.length-1?h.value+=1:Y()},B=()=>{h.value>0?h.value-=1:P()},L=t=>t.map(a=>we(a)?a:e(a[0],a[1])),G=t=>{if(t.type==="customField"){const a=ce[t.index]||"$content",[d,c=""]=ue(a)?a[q.value].split("$content"):a.split("$content");return t.display.map(u=>e("div",L([d,...u,c])))}return t.display.map(a=>e("div",L(a)))},H=()=>{l.value=0,h.value=0,r("updateQuery",""),r("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},o.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},m.value.map((t,a)=>{const d=i.isQuery&&i.index===a;return e("li",{class:["slimsearch-record-matches",{active:d}],role:"option","aria-selected":d,onClick:()=>{r("updateQuery",t)}},e("div",[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},t),e("button",{type:"button",class:"slimsearch-remove-icon",title:o.value.remove,"aria-label":o.value.remove,innerHTML:j,onClick:c=>{c.preventDefault(),c.stopPropagation(),R(a)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},o.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},y.value.map((t,a)=>{const d=!i.isQuery&&i.index===a;return e("li",{class:["slimsearch-record-matches",{active:d}],role:"option","aria-selected":d},e(I,{to:t.link,onClick:()=>{H()}},()=>[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[t.header?e("div",{class:"slimsearch-record-content-header"},t.header):null,e("div",t.display.map(c=>L(c)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:o.value.remove,"aria-label":o.value.remove,innerHTML:j,onClick:c=>{c.preventDefault(),c.stopPropagation(),v(a)}})]))}))]));return le("keydown",t=>{if(s.isFocusing){if(S.value){if(t.key==="ArrowUp")B();else if(t.key==="ArrowDown")z();else if(t.key==="Enter"){const a=C.value.contents[h.value];w(s.queries.join(" ")),f(a),n.push(E(a)),H()}}else if(t.key==="ArrowUp")_();else if(t.key==="ArrowDown")O();else if(t.key==="Enter"){const{index:a}=i;i.isQuery?(t.preventDefault(),r("updateQuery",m.value[a])):(n.push(y.value[a].link),H())}}}),se([l,h],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:s.queries.length?!S.value:!A.value}]},s.queries.length?$.value?e(oe,{hint:o.value.searching}):S.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},p.value.map(({title:t,contents:a},d)=>{const c=l.value===d;return e("div",{class:["slimsearch-record",{active:c}],role:"group","aria-selected":c},[e("div",{class:"slimsearch-record-title"},t||o.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},a.map((u,V)=>{const F=c&&h.value===V;return e("li",{class:["slimsearch-record-matches",{active:F}],role:"option","aria-selected":F},e(I,{to:E(u),onClick:()=>{w(s.queries.join(" ")),f(u),H()}},()=>[u.type==="text"?null:e(u.type==="title"?ie:u.type==="heading"?re:ne,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[u.type==="text"&&u.header?e("div",{class:"slimsearch-record-content-header"},u.header):null,e("div",G(u))])]))}))])})):o.value.emptyResult:A.value?[J(),K()]:o.value.emptyHistory)}});export{Se as default};
